<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lz.manage.mapper.StatisticsMapper">
    <select id="collectStatistics" resultType="com.lz.manage.model.statistics.po.StatisticsPo">
        select DATE(create_time) as name, count(*) as value
        from tb_collect
        <where>
            <if test="startTime != null">
                and create_time >= #{startTime}
            </if>
            <if test="endTime != null">
                and create_time &lt;= #{endTime}
            </if>
            <if test="type != null">
                and type = #{type}
            </if>
        </where>
        group by DATE(create_time)
    </select>
    <select id="collectRankStatistics" resultType="com.lz.manage.model.statistics.po.StatisticsPo">
        select target_id as name, count(*) as value
        from tb_collect
        <where>
            <if test="startTime != null">
                and create_time >= #{startTime}
            </if>
            <if test="endTime != null">
                and create_time &lt;= #{endTime}
            </if>
            <if test="type != null">
                and type = #{type}
            </if>
        </where>
        group by name order by value desc
    </select>
    <select id="orderRatioStatistics" resultType="com.lz.manage.model.statistics.po.StatisticsPo">
        select status as name, count(*) as value
        from tb_order
        <where>
            <if test="startTime != null">
                and create_time >= #{startTime}
            </if>
            <if test="endTime != null">
                and create_time &lt;= #{endTime}
            </if>
        </where>
        group by name
    </select>
    <select id="orderAmountStatistics" resultType="com.lz.manage.model.statistics.po.StatisticsPo">
        select DATE(create_time) as name, sum(total_price) as value
        from tb_order
        <where>
            <if test="startTime != null">
                and create_time >= #{startTime}
            </if>
            <if test="endTime != null">
                and create_time &lt;= #{endTime}
            </if>
        </where>
        group by name
    </select>
</mapper>
